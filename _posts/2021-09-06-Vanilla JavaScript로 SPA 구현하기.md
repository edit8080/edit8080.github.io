---
title:  "Vanilla JavaScriptë¡œ ê°„ë‹¨í•œ SPA êµ¬í˜„í•˜ê¸°"
excerpt: "JavaScriptì™€ SPA"

categories:
 - JavaScript
tags:
 - [project], [SPA]

toc: true
toc_sticky: true

date: 2021-09-06
last_modified_at: 2021-09-06

published: true
---

## 1. 2021ë…„ í•˜ë°˜ê¸° í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ í”„ë¡ íŠ¸ì—”ë“œ ë°ë¸Œ ë§¤ì¹­ ì°¸ê°€ íšŒê³ 

ì§€ë‚œ í† ìš”ì¼ì— 2021ë…„ í•˜ë°˜ê¸° í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ í”„ë¡ íŠ¸ì—”ë“œ ë°ë¸Œ ë§¤ì¹­ ê³¼ì œê°€ ìˆì—ˆë‹¤.
ì¢‹ì€ ê²½í—˜ì´ ë  ê²ƒ ê°™ì•„ ì°¸ê°€í•œ ê²°ê³¼ë¡œëŠ” ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ì—†ì—ˆì§€ë§Œ ë‚´ê°€ ëª°ëë˜ ìƒˆë¡œìš´ ê³¼ì œë¥¼ ë§ˆì£¼í•˜ê²Œ ë˜ì–´ ì˜¤íˆë ¤ ìƒˆë¡œìš´ ìê·¹ì´ ë˜ì—ˆë˜ ê²ƒ ê°™ë‹¤.
(ê·¸ë ‡ê²Œ í¬ê²Œ ê¸°ëŒ€í•˜ì§€ ì•Šì•„ì„œ ì‹¤ë§ê°ì´ ë³„ë¡œ ì—†ì—ˆë˜ ê²ƒ ê°™ë‹¤. ğŸ˜†)

ê³¼ì œì˜ í•µì‹¬ì ì¸ êµ¬í˜„ì‚¬í•­ì€ ì—­ì‹œ ê¸°ì¡´ì— ìƒê°í•œ ëŒ€ë¡œ ì™¸ë¶€ API ë°ì´í„°ë¥¼ í˜¸ì¶œí•˜ì—¬ ì›¹ í˜ì´ì§€ë¥¼ ë Œë”ë§í•˜ëŠ” ì „í˜•ì ì¸ í”„ë¡ íŠ¸ì—”ë“œ ê³¼ì œì˜€ë‹¤.
ì´ ë¶€ë¶„ì€ ì˜ˆìƒí•˜ê³  ìˆì—ˆì§€ë§Œ Vanilla JSë¡œ SPAë¥¼ êµ¬í˜„í•´ì•¼í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í–ˆê¸°ì— ì´ ë¶€ë¶„ ë•Œë¬¸ì— ë¬¸ì œë¥¼ í•´ê²°í•˜ì§€ ëª»í–ˆë‹¤.
ë‹¤ìŒì— ë¹„ìŠ·í•œ ê¸°íšŒê°€ ìˆì„ ë•ŒëŠ” í•´ê²°í•  ìˆ˜ ìˆë„ë¡ ì¤€ë¹„í•˜ê¸° ìœ„í•´ Vanilla JSë¡œ SPA êµ¬í˜„í•˜ëŠ” ê³¼ì •ì„ ì—¬ëŸ¬ ìë£Œë¥¼ ì°¸ê³ í•˜ë©´ì„œ êµ¬í˜„í•´ë³´ì•˜ë‹¤.

## 2. SPA êµ¬í˜„ê³„íš

SPAë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œ ë‹¨ìˆœí•œ í˜ì´ì§€ ë Œë”ë§ì´ ì•„ë‹ˆë¼ ì‹¤ì œ APIì— ë§ê²Œ ë™ì‘í•˜ê¸° ìœ„í•œ ì´ë²¤íŠ¸ ë° ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì— ì´ˆì ì„ ë‘ì–´ êµ¬ì„±í•˜ê¸°ë¡œ ê³„íší–ˆë‹¤.
ì´ë¥¼ ë‹¨ìˆœí™”í•˜ê³  ì„œë¡œ ë¹„êµí•˜ê¸° ìœ„í•´ ë‘ ê°€ì§€ ê¸°ëŠ¥ì„ êµ¬ì„±í•˜ê¸°ë¡œ í–ˆë‹¤.

1. ì„œë¡œ ë‹¤ë¥¸ URLì„ ê¸°ì¤€ìœ¼ë¡œ í˜ì´ì§€ êµ¬ì„±í•˜ê¸°
2. ë™ì¼í•œ URLì´ì§€ë§Œ ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ì´ë‚˜ URL íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ ê°œë³„ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” í˜ì´ì§€ êµ¬ì„±í•˜ê¸°

## 3. Vanilla JSë¡œ SPA êµ¬í˜„í•˜ê¸°

SPAë¥¼ êµ¬í˜„í•˜ëŠ”ë° ìˆì–´ì„œ ë‹¤ìŒì˜ [ë¸”ë¡œê·¸](https://kdydesign.github.io/2020/10/06/spa-route-tutorial/)ë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ì„±í•˜ì˜€ë‹¤.

ë‚˜ëŠ” ì—¬ê¸°ì„œ historyë¥¼ í™œìš©í•˜ì—¬ SPAë¥¼ êµ¬í˜„í•˜ê¸°ë¡œ ê²°ì •í•˜ì˜€ë‹¤.
historyë¥¼ í™œìš©í•˜ì—¬ SPAë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œ history ê°ì²´ì˜ `pushState` í•¨ìˆ˜ì™€ windowì˜ `popstate` ì´ë²¤íŠ¸ë¥¼ ì£¼ë¡œ í™œìš©í•œë‹¤.
ê°€ì¥ ë¨¼ì € `pushState` í•¨ìˆ˜ëŠ” ë¸Œë¼ìš°ì €ì˜ ì„¸ì…˜ ê¸°ë¡ ìŠ¤íƒì— ìƒíƒœë¥¼ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜ë¡œ ì‚¬ìš©ìì˜ ë°©ë¬¸ ê¸°ë¡ì„ ì €ì¥í•˜ê³  ì§€ì •í•œ URL ê²½ë¡œë¡œ ì´ë™ì‹œì¼œì£¼ëŠ” ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.

> pushStateëŠ” pushState(state, title, url) êµ¬ì¡°ë¡œ ì´ë£¨ì–´ì ¸ìˆëŠ”ë° stateëŠ” ì´ì „, ë‹¤ìŒ í˜ì´ì§€ë¥¼ ì´ë™í•  ë•Œ ì‚¬ìš©í•  ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ í™œìš©ë˜ê³ , urlì€ í˜ì´ì§€ë¥¼ ì´ë™í•  ë•Œ í™œìš©ëœë‹¤.
>
> í•˜ì§€ë§Œ titleì€ ì•„ì§ ì¤‘ì ì ìœ¼ë¡œ í™œìš©ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤ê³  í•œë‹¤.

ë‹¤ìŒìœ¼ë¡œ `popstate` ì´ë²¤íŠ¸ëŠ” ì‚¬ìš©ìì˜ ì„¸ì…˜ ê¸°ë¡ìœ¼ë¡œ ì¸í•´ í˜„ì¬ í™œì„±í™”ëœ ê²½ë¡œê°€ ë³€ê²½ë  ë•Œ ë°œìƒí•œë‹¤.
ë”°ë¼ì„œ, `pushState`ë¡œ ì €ì¥í•œ ë°©ë¬¸ ê¸°ë¡ì— ê¸°ë°˜í•´ URLì„ ì´ë™í•˜ê²Œ ë˜ë©´ `popstate` ì´ë²¤íŠ¸ê°€ ë°œìƒí•œë‹¤.
ì´ë¥¼ í†µí•´, ì´ì „ í˜ì´ì§€ë‚˜ ë‹¤ìŒ í˜ì´ì§€ë¡œ í˜ì´ì§€ë¥¼ ì´ë™í•  ë•Œ `popstate` ì´ë²¤íŠ¸ë¥¼ í†µí•´ SPA í˜ì´ì§€ë¥¼ ì—°ì†ì ìœ¼ë¡œ ì´ë™í•  ìˆ˜ ìˆë‹¤.

> ì´ì „ ë°©ë¬¸ ê¸°ë¡ì— ê¸°ë°˜í•´ ì´ë™í•˜ê¸° ë•Œë¬¸ì— ì§ì ‘ì ìœ¼ë¡œ URLì„ ì…ë ¥í•˜ì—¬ ì´ë™í•˜ëŠ” ê²½ìš° `popstate` ì´ë²¤íŠ¸ë¥¼ í†µí•´ í˜ì´ì§€ë¥¼ ë Œë”ë§í•  ìˆ˜ ì—†ë‹¤.

ì´í›„ í•µì‹¬ì ì¸ router ë¡œì§ì„ êµ¬ì„±í•˜ì˜€ë‹¤. index.html êµ¬ì¡°ì™€ ê° í˜ì´ì§€ë¥¼ ë Œë”ë§í•˜ëŠ” HTML Element íƒœê·¸ëŠ” ê°„ë‹¨í•˜ê²Œ ì§€ì •í•˜ì˜€ìœ¼ë¯€ë¡œ ì„¤ëª… ì—†ì´ ë„˜ì–´ê°€ë„ë¡ í•œë‹¤. ê¶ê¸ˆí•˜ë‹¤ë©´ í•˜ë‹¨ì˜ êµ¬í˜„ ê²°ê³¼ì˜ ìµœì¢… ì½”ë“œë¥¼ ì°¸ê³ í•œë‹¤.

~~~javascript

/* router.js */
import { aboutEl, homeEl, productEl } from "./htmlEl.js";

const $app = document.querySelector("#app");
const $links = document.querySelectorAll("[route^='/']");

// ê° ë¼ìš°íŒ… í˜ì´ì§€ëŠ” í•¨ìˆ˜ë¡œ ê´€ë¦¬ -> ì™¸ë¶€ API ë°ì´í„° ì²˜ë¦¬ í›„ HTML Elementë¥¼ êµ¬ì„±í•˜ì—¬ ë°˜í™˜í•˜ëŠ” í˜•íƒœë¡œ í™•ì¥
const routes = {
  "/": homeEl,
  "/about": aboutEl,
  "/product": productEl,
};

// ê° ë§í¬ ìš”ì†Œì— ëŒ€í•´ í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€ -> API ë°ì´í„°ë¡œ ë Œë”ë§í•œ ìš”ì†Œì˜ í´ë¦­ ì´ë²¤íŠ¸ ë“±ìœ¼ë¡œ í™•ì¥
$links.forEach(($link) => {
  $link.addEventListener("click", (e) => {
    const pathName = e.target.getAttribute("route"); // ì§€ì •í•œ ê²½ë¡œ Fetch
    console.log(pathName);
    
    window.history.pushState({}, pathName, pathName); // í˜ì´ì§€ ì´ë™
    $app.innerHTML = routes[pathName](); // ì´ë™í•œ í˜ì´ì§€ ë Œë”ë§
  });
});

// ì´ì „ í˜ì´ì§€, ë‹¤ìŒ í˜ì´ì§€ë¡œ ì´ë™í•  ë•Œ ë Œë”ë§
window.onpopstate = () => {
  $app.innerHTML = routes[window.location.pathname]();
};

// ì´ˆê¸° ë¼ìš°íŒ…
$app.innerHTML = routes["/"]();

~~~

ê°€ì¥ ë¨¼ì € ê° í˜ì´ì§€ë¥¼ êµ¬ì„±í•˜ëŠ” HTML ìš”ì†Œë“¤ì„ ê´€ë¦¬í•˜ì˜€ë‹¤. HTML ìš”ì†ŒëŠ” í™•ì¥ì„±ì„ ê³ ë ¤í•´ í•¨ìˆ˜ë¡œ ê´€ë¦¬í•˜ë„ë¡ ì„¤ì •í•˜ì˜€ë‹¤.
ì´í›„ ê° í˜ì´ì§€ë¥¼ ì´ë™í•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì— ëŒ€í•´ ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•´ì£¼ì—ˆë‹¤. ì§€ê¸ˆ ì—¬ê¸°ì„œëŠ” í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì˜€ê³  `route` ì†ì„±ê°’ìœ¼ë¡œ ì €ì¥í•œ URL ê²½ë¡œë¥¼ ê°€ì ¸ì™€ í˜ì´ì§€ë¥¼ ì´ë™í•˜ì˜€ë‹¤.
í˜ì´ì§€ë¥¼ ì´ë™í•˜ëŠ”ë° ìœ„ì—ì„œ ì„¤ëª…í•œ `pushState` í•¨ìˆ˜ë¥¼ í™œìš©í•˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.
ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ì „ í˜ì´ì§€ì™€ ë‹¤ìŒ í˜ì´ì§€ë¡œ ì´ë™í•´ë„ SPAë¥¼ ë Œë”ë§í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•´ `onpopstate` ì´ë²¤íŠ¸ë¥¼ í†µí•´ ê° í˜ì´ì§€ë¥¼ ë Œë”ë§í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í•˜ì˜€ë‹¤.

ì´ë ‡ê²Œ í•´ì„œ ì„œë¡œ ë‹¤ë¥¸ URLì„ ê¸°ì¤€ìœ¼ë¡œ í˜ì´ì§€ë¥¼ ì´ë™í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ êµ¬ì„±í•˜ì˜€ë‹¤.
ê·¸ë ‡ë‹¤ë©´ ì´ì œ 2ë²ˆ ê³„íšì„ ë‹¬ì„±í•˜ê¸° ìœ„í•´ `/products/1` ì´ë‚˜ `/products?pId=1` ê³¼ ê°™ì€ URLì— ëŒ€í•´ íŠ¹ì • ì œí’ˆì— ëŒ€í•´ í˜ì´ì§€ë¥¼ ë Œë”ë§í•˜ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì•¼í•œë‹¤.
ì‚¬ì‹¤ ì´ ë¶€ë¶„ì€ routerì—ì„œ ìˆ˜í–‰í•˜ê¸°ë³´ë‹¤ ë Œë”ë§í•  HTML ìš”ì†Œë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ êµ¬ì„±í•˜ëŠ” ë¶€ë¶„ì—ì„œ ë‹´ë‹¹í•œë‹¤.

ìš°ì„  URL ê²½ë¡œì— ë§¤ê°œë³€ìˆ˜ë‚˜ ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ì„ ì¶”ê°€í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— `pushState`ë¥¼ í†µí•´ URLì„ ì§€ì •í•˜ëŠ” ë¶€ë¶„ì˜ pathNameì„ ë‹¤ìŒê³¼ ê°™ì´ ì‚´ì§ ë³€í˜•ì‹œì¼œì¤¬ë‹¤.
ë‚˜ëŠ” ë§í¬ ë²„íŠ¼ì— `data-id` ì†ì„±ê°’ìœ¼ë¡œ ì œí’ˆ IDë¥¼ ë¶€ì—¬í•˜ì—¬ í˜ì´ì§€ë¥¼ ì´ë™í•  ë•Œ í™œìš©í•  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ë‹¤.

> ë§¤ê°œë³€ìˆ˜(/:id í˜•íƒœ) - <code>pathName + \`${pathName === "/product" ? "/" + e.target.dataset.id : ""}\`</code>
>
> ì¿¼ë¦¬ìŠ¤íŠ¸ë§(?pid=1 í˜•íƒœ) - <code>pathName + \`${pathName === "/product" ? "?pid=" + e.target.dataset.id : ""}\`</code>

ì´í›„ ë‘ ê°€ì§€ ê²½ìš°ì— ëŒ€í•´ ì§€ì •í•œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ íŒŒì‹±í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•œë°, ë§¤ê°œë³€ìˆ˜ë¥¼ í†µí•´ ê²½ë¡œë¥¼ ì´ë™í•˜ëŠ” ê²½ìš° URLì„ / ë¥¼ ê¸°ì¤€ìœ¼ë¡œ íŒŒì‹±í•˜ì—¬ ì‚¬ìš©í•˜ì˜€ë‹¤.

~~~JavaScript

// ë§¤ê°œë³€ìˆ˜ íŒŒì‹±
export function productEl() {
  const urlParse = window.location.pathname.split("/");
  const pid = urlParse[urlParse.length - 1];

  return `<h1>${pId}ë²ˆì§¸ ì œí’ˆì…ë‹ˆë‹¤.</h1>`;
}

~~~

ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ì„ íŒŒì‹±í•  ë•ŒëŠ” ë‹¤ìŒ [ì‚¬ì´íŠ¸](https://gent.tistory.com/62)ì˜ ì •ê·œí‘œí˜„ì‹ì„ ì°¸ê³ í•˜ì˜€ë‹¤.

~~~JavaScript

// ì¿¼ë¦¬ìŠ¤íŠ¸ë§ íŒŒì‹±
export function productEl() {
  let queryStr = {};

  // ?A=B ë‚˜ &A=B ê¸°ì¤€ìœ¼ë¡œ íŒŒì‹±
  window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (_, key, value) {
    queryStr[key] = value;
  });

  return `<h1>${queryStr.pid}ë²ˆì§¸ ì œí’ˆì…ë‹ˆë‹¤.</h1>`;
}

~~~

ë§ˆì§€ë§‰ìœ¼ë¡œ, ìœ„ì—ì„œ ì„¤ëª…í•œ URL íŒŒì‹±ì„ í† ëŒ€ë¡œ `onpopstate` ì´ë²¤íŠ¸ í•¨ìˆ˜ì—ì„œë„ ìœ ì‚¬í•œ ë°©ì‹ìœ¼ë¡œ URL íŒŒì‹±ì´ ì´ë£¨ì–´ì§€ë„ë¡ ë³€ê²½í•˜ë©´ ê¸°ë³¸ì ì¸ SPA êµ¬ì„±ì´ ì™„ë£Œëœë‹¤.

## 4. êµ¬í˜„

<iframe src="https://codesandbox.io/embed/amazing-fire-lvpfh?fontsize=14&hidenavigation=1&theme=dark"
     style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"
     title="amazing-fire-lvpfh"
     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
   ></iframe>

â€» codesandbox í™˜ê²½ì—ì„œ onpopstateì˜ ì´ì „, ë‹¤ìŒ í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” ê¸°ëŠ¥ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤. ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì˜€ë‹¤.

<ì°¸ê³  ìë£Œ>

1. [Vanilla JSì—ì„œ SPA ë¼ìš°íŒ… ì‹œìŠ¤í…œ êµ¬í˜„í•˜ê¸°](https://kdydesign.github.io/2020/10/06/spa-route-tutorial/)
2. [MDN - History.pushState()](https://developer.mozilla.org/ko/docs/Web/API/History/pushState)
3. [MDN - popstate](https://developer.mozilla.org/ko/docs/Web/API/Window/popstate_event)
4. [URL(ì£¼ì†Œ) Query String ì‰½ê²Œ ê°€ì ¸ì˜¤ê¸° (ì¸ì, íŒŒë¼ë¯¸í„°, param)](https://gent.tistory.com/62)